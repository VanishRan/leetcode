

<img src="/Users/mahuanran/Documents/leetcode/elasticsearch/图片/p1.png" alt="p1" style="zoom:20%;" />

##### 2.1 空集群

一个节点**(node)**就是一个Elasticsearch实例，而一个集群**(cluster)**由一个或多个节点组成，它们具有相同的	cluster.name	， 

它们协同工作，分享数据和负载。当加入新的节点或者删除一个节点时，集群就会感知到并平衡数据。

集群中一个节点会被选举为主节点**(master)**,它将临时管理集群级别的一些变更，例如新建或删除索引、增加或移除节点等。



##### 2.2 集群健康

GET	/_cluster/health



##### 2.3 添加索引

索引：索引只是一个用来指向一个或多个分片**(shards)**的**“**逻辑命名空间**(logical	namespace)”**.一个分片**(shard)**是一个最小级别**“**工作单元**(worker	unit)”**,它只是保存了索引中所有数据的一部分。

让我们在集群中唯一一个空节点上创建一个叫做	blogs	的索引。默认情况下，一个索引被分配5个主分片，但是为了演示的目

的，我们只分配3个主分片和一个复制分片（每个主分片都有一个复制分片）：

PUT	/blogs

{

"settings"	:	{

"number_of_shards"	:	3,

"number_of_replicas"	:	1

​			}

} 



##### 2.4 增加故障转移 

在单一节点上运行意味着有单点故障的风险——没有数据备份。幸运的是，要防止单点故障，我们唯一需要做的就是启动另

一个节点。

<img src="/Users/mahuanran/Documents/leetcode/elasticsearch/图片/p2.png" alt="p2" style="zoom:33%;" />

第二个节点已经加入集群，三个复制分片**(replica	shards)**也已经被分配了——分别对应三个主分片，这意味着在丢失任意一

个节点的情况下依旧可以保证数据的完整性。



##### 2.5 横向扩展

<img src="/Users/mahuanran/Documents/leetcode/elasticsearch/图片/p3.png" alt="p3" style="zoom:33%;" />

从	Node	1	和	Node	2	来的分片已经被移动到新的	Node	3	上，这样每个节点就有两个分片，以代替之前的三个。这意味着每个

节点的硬件资源（CPU、RAM、I/O）被较少的分片共享，这样每个分片就会有更好的表现。

分片本身就是一个完整成熟的搜索引擎，它可以使用单一节点的所有资源。使用这6个分片（3个主分片和三个复制分片）我

们可以扩展最多到6个节点，每个节点上有一个分片，这样就可以100%使用这个节点的资源了。





##### 2.6 更多扩展

增加复制分片